---
title: "My Data Visualisation Project"
author: "Seline Uran"
output: html_document
---
```{r = diagram1, echo=FALSE, message=FALSE}
#To begin load the following libraries
library(ggplot2)
library(readxl)
library(RColorBrewer)
library(scales)
library(dplyr)
library(tidyr)
library(tidyverse)
```

<span style="text-decoration:underline">Research Questions</span>

These graphs present government survey data on the number of Rough Sleepers in England to consider the question; 

       1) Has homelessness increased over the past decade? 

       2) Is this increase observed equally across all regions of England? 

<span style="text-decoration:underline">Data Origins</span>

<span style="text-decoration:underline">Data Preparation</span>

After having removed all sheets from the excel document except for the sheet that contained the total number of rough sleepers I began data preparation. 

```{r}
#importing the raw data
rawdata <- read_excel("~/myfinalproject/processed/rs_statistics.xlsx")
```

The raw data detailed the number of rough sleepers within England and individual counts for each region of England and each Local Authority within each region. 

As I was visualising the number of rough sleepers in each region of England across the last 10 years, as such I selected these rows from the data set. 

```{r}
#slice the data to select the rows required
rs2<- rawdata %>% slice(1:11)
```

Since I aimed to visualize the number of rough sleepers in each region individually I removed the rows containing summary counts for 'England', 'London' and the 'Rest of England'. 

```{r}
#columns removed from the data
rs2<- rs2[-c(1:3), ]
```

Then, I removed data associated with each Local Authority, columns containing the ONS code of each Region and Local Authority. 

```{r}
rs2$`Local authority ONS code`<-NULL
rs2$`Local authority`<-NULL
rs2$`Region ONS code`<- NULL
```

Finally, I tidyed the data and converted it into a long format so that it would be in a preferred format for use with ggplot2.

```{r}
#convert to a 'long' data set
rs2_long <- rs2 %>% 
  gather(Year, Number, -Region)
```

The tibble below shows a short section of the output and exemplifies the 'long' (as opposed to a wide) format the data set had been converted to. 

```{r}
head(rs2_long, 16)
```

I then performed the same steps to prepare the data for the second graph to be visualised; a pie chart of rough sleepers in each region of England, in 2019. 

```{r}
rs3<- rawdata %>% slice(1:11)

rs3<- rs3[-c(1:3), ]

rs3$`Local authority ONS code`<-NULL
rs3$`Local authority`<-NULL
rs3$`Region ONS code`<- NULL
rs3$`2010`<-NULL
rs3$`2011`<-NULL
rs3$`2012`<- NULL
rs3$`2013`<-NULL
rs3$`2014`<-NULL
rs3$`2015`<- NULL
rs3$`2016`<-NULL
rs3$`2017`<-NULL
rs3$`2018`<- NULL
rs3$`2020`<-NULL

rs3_long <- rs3 %>% 
  gather(Year, Number, -Region)
```

And the third graph which is also a pie chart. 

```{r}
rawdata2<-read_excel("~/myfinalproject/processed/population.xlsx")

rs4<- rawdata2 %>% slice(9, 23, 67, 92, 138, 173, 258, 329)
rs4<- rs4 %>% select(2, 5)
rs4<- rs4 %>% 
  rename(
    Region = ...2,
   "2019" = ...5)

rs4_long <- rs4 %>% 
  gather(Year, Number, -Region)
rs4_long$Number <- as.numeric(as.character(rs4_long$Number))

rs4pie<- data.frame(rs4_long)
```

<span style="text-decoration:underline">Visualisation</span> 

Graph 1: Number of Rough Sleepers in England by Region (2010 - 2020)

```{r = graph1, message=FALSE, results='hide'}
rs2plot <-ggplot(rs2_long, aes(x = Year, y = Number, color = Region, group = Region)) +
  geom_point() +
  geom_line(position = position_dodge(0.4)) +
  scale_color_brewer(palette = 'Dark2') +
    theme(axis.text.x = element_text(face= "bold", color="black", 
                                 size=7),
        axis.text.y = element_text(face= "bold", color="black", 
                                  size=7),
        axis.line = element_line(colour = "black", 
                    size = 1, linetype = "solid")) +
  labs(title="Number of Rough Sleepers in England by Region (2010 - 2020)",
       x="Year", y = "Number of Rough Sleepers") + 
  scale_y_continuous(breaks=c(0, 300, 600, 900, 1200), limits=c(0, 1200))

ggsave("figures/rs2plot.png")
```

```{r echo=FALSE, warning=FALSE}
rs2plot
```


Graph 2: Number of Rough Sleepers in England by Region (2019) 

```{r = graph2, message=FALSE, results='hide'}
rs3pie<- data.frame(rs3_long)

bp<- ggplot(rs3pie, aes(x="", y=Number, fill=Region))+
  geom_bar(width = 1, stat = "identity") + 
  ggtitle("help") +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.grid  = element_blank(),
        legend.position="none",
        line = element_blank()
  ) + scale_fill_brewer(palette="Dark2")

piechart<- bp + coord_polar("y", start=0) + 
    theme_void() +
    ggtitle("Proportion of Rough sleepers by Population in each Region of England (2019)")

ggsave("figures/piechart.png")
```

```{r, echo=FALSE}
piechart
```

Graph 3: Population of each Region in England (2019) 

```{r = graph3, message=FALSE, results='hide'}
bp<- ggplot(rs4pie, aes(x="", y=Number, fill=Region))+
  geom_bar(width = 1, stat = "identity") + 
  ggtitle("help") +
  theme(axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank(),
        panel.grid  = element_blank(),
        legend.position="none",
        line = element_blank()
  ) + scale_fill_brewer(palette="Dark2")

piechart2<- bp + coord_polar("y", start=0) + 
  theme_void() + # remove background, grid, numeric labels
  ggtitle("Population of each region in England in 2019")

ggsave("figures/piechart.png")
```

```{r, echo=FALSE, message=FALSE, results='hide'}
piechart2
```


<span style="text-decoration:underline">Summary</span>

The above graphs show that the number of rough sleepers in England has increased overall, across all regions between 2010 - 2020. 

<span style="text-decoration:underline">Future Directions</span>


