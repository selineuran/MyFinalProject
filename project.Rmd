---
title: "My Data Visualisation Project"
author: "Seline Uran"
output: html_document
---
```{r = diagram1, echo=FALSE, message=FALSE}
#To begin load the following libraries
library(ggplot2)
library(readxl)
library(RColorBrewer)
library(scales)
library(dplyr)
library(tidyr)
library(tidyverse)
```

<span style="text-decoration:underline">Data Origins</span>

<span style="text-decoration:underline">Research Questions</span>

<span style="text-decoration:underline">Data Preparation</span>

After having removed all sheets from the excel document except for that which contained the total number of rough sleepers I began data preparation. To begin preparing the data for my project's main visualization I imported the raw data as seen below. 

```{r}

rawdata <- read_excel("~/myfinalproject/processed/rs_statistics.xlsx")
```

The raw daw data provided the number of rough sleepers within all regions of England. In addition, there was data on the number of rough sleepers in each each Local Authority of each region witin England. 

Since I was interested in comparing the number of rough sleepers in England by region I selected only these rows from the raw data as below. 

```{r}
rs2<- rawdata %>% slice(1:11)

rs2
```

I aimed to compare the number of rough sleepers by each region within England as such I removed the rows containing summary counts for England, London and the Rest of England. 

```{r}
rs2<- rs2[-c(1:3), ]

rs2
```

I also removed the colums associted with information on Local Authorities and ONS code associated with each region which was not necessary to the visualisation. 

```{r}
rs2$`Local authority ONS code`<-NULL
rs2$`Local authority`<-NULL
rs2$`Region ONS code`<- NULL

rs2[1:12]
```

Finally, I converted the data from a wide to a long format so that it would be in a preferred format for generating a graph with ggplot2.

```{r}
rs2_long <- rs2 %>% 
  gather(Year, Number, -Region)

head(rs2_long, 16)
```

I then performed the same steps to prepare the data for the second graph - the piechart. 

```{r}
rs3 <- read_excel("~/myfinalproject/processed/rs_statistics.xlsx")

rs3<- rawdata %>% slice(1:11)

rs3<- rs3[-c(1:3), ]

rs3$`Local authority ONS code`<-NULL
rs3$`Local authority`<-NULL
rs3$`Region ONS code`<- NULL

rs3$`2010`<-NULL
rs3$`2011`<-NULL
rs3$`2012`<- NULL
rs3$`2013`<-NULL
rs3$`2014`<-NULL
rs3$`2015`<- NULL
rs3$`2016`<-NULL
rs3$`2017`<-NULL
rs3$`2018`<- NULL
rs3$`2019`<-NULL

rs3_long <- rs3 %>% 
  gather(Year, Number, -Region)

rs3_long
```


<span style="text-decoration:underline">Visualisation</span> 

The Main Visualisation

```{r = maindiagram, echo=FALSE, message=FALSE, results='hide'}
rs2plot <-ggplot(rs2_long, aes(x = Year, y = Number, color = Region, group = Region)) +
  geom_point() +
  geom_line() +
  scale_color_brewer(palette = 'Dark2') +
  theme_classic(base_size = 12)

rs2plot

ggsave("figures/rs2plot.png")
```


Piechart

```{r = diagram3,echo=FALSE, message=FALSE, results='hide'}
rs3pie<- data.frame(rs3_long)

bp<- ggplot(rs3pie, aes(x="", y=Number, fill=Region))+
  geom_bar(width = 1, stat = "identity")

pie <- bp + coord_polar("y", start=0)

blank_theme <- theme_minimal()+
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    panel.border = element_blank(),
    panel.grid=element_blank(),
    plot.title=element_text(size=14, face="bold")
  )

pie<- pie + scale_fill_brewer(palette="Dark2") + blank_theme +
  theme(axis.text.x=element_blank())+
  geom_text(aes(y = Number/3 + c(0, cumsum(Number)[-length(Number)]), 
                label = percent(Number/100)), size=0)

pie
```


<span style="text-decoration:underline">Summary</span>


<span style="text-decoration:underline">Future Directions</span>


