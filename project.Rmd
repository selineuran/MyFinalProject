---
title: "My Data Visualisation Project"
author: "Seline Uran"
output: html_document
---
```{r = diagram1, echo=FALSE, message=FALSE}
#To begin load the following libraries
library(ggplot2)
library(readxl)
library(RColorBrewer)
library(scales)
library(dplyr)
library(tidyr)
library(tidyverse)
```

<span style="text-decoration:underline">Data Origins</span>

<span style="text-decoration:underline">Research Questions</span>

<span style="text-decoration:underline">Data Preparation</span>

After having removed all sheets from the excel document except for that which contained the total number of rough sleepers I began data preparation. To begin preparing the data for my project's main visualization I imported the raw data as seen below. 

```{r}
rawdata <- read_excel("~/myfinalproject/processed/rs_statistics.xlsx")
```

The raw data detailed the number of rough sleepers within England and included individual counts for each region of England and each Local Authority within the each region. 

For my data visualisation I was interested in visualising the number of rough sleepers in all the regions of England across the last 10 years, as such I began by removing thewe rows from the original dataset (as shown below). 

```{r}
rs2<- rawdata %>% slice(1:11)
```

Since I aimed to visualize the number of rough sleepers in each region individually within England I removed the rows containing summary counts for 'England', 'London' and the 'Rest of England'. 

```{r}
rs2<- rs2[-c(1:3), ]
```

In addition to removing data associated with each Local Authority (which was not be part of the visualization) I also removed the columns that contained information relating to the ONS code associated with each region and Local Authority in England.

```{r, echo=FALSE, message=FALSE, results='hide'}
rs2$`Local authority ONS code`<-NULL
rs2$`Local authority`<-NULL
rs2$`Region ONS code`<- NULL

rs2[1:12]
```

Finally, I converted the data from a wide to a long format so that it would be in a preferred format for generating a graph with ggplot2.

```{r}
rs2_long <- rs2 %>% 
  gather(Year, Number, -Region)
```


The tibble below shows a short section of the output and exemplifies the 'long' (as opposed to a wide) format the data set had been converted to. 

```{r}
head(rs2_long, 16)
```

I then performed the same steps to prepare the data for the second graph to be visualised; a pie chart of all the rough sleepers in 2020 in each region of England. 

```{r}
rawdata <- read_excel("~/myfinalproject/processed/rs_statistics.xlsx")

rs3<- rawdata %>% slice(1:11)

rs3<- rs3[-c(1:3), ]

rs3$`Local authority ONS code`<-NULL
rs3$`Local authority`<-NULL
rs3$`Region ONS code`<- NULL
rs3$`2010`<-NULL
rs3$`2011`<-NULL
rs3$`2012`<- NULL
rs3$`2013`<-NULL
rs3$`2014`<-NULL
rs3$`2015`<- NULL
rs3$`2016`<-NULL
rs3$`2017`<-NULL
rs3$`2018`<- NULL
rs3$`2019`<-NULL

rs3_long <- rs3 %>% 
  gather(Year, Number, -Region)
```


<span style="text-decoration:underline">Visualisation</span> 

The Main Visualisation

```{r = maindiagram, echo=FALSE, message=FALSE, results='hide'}
rs2plot <-ggplot(rs2_long, aes(x = Year, y = Number, color = Region, group = Region)) +
  geom_point() +
  geom_line(position = position_dodge(0.4)) +
  scale_color_brewer(palette = 'Dark2') +
  theme_classic(base_size = 12)

rs2plot

ggsave("figures/rs2plot.png")
```


Pie chart

```{r = diagram3,echo=FALSE, message=FALSE, results='hide'}
rs3pie<- data.frame(rs3_long)

bp<- ggplot(rs3pie, aes(x="", y=Number, fill=Region))+
  geom_bar(width = 1, stat = "identity")

pie <- bp + coord_polar("y", start=0)

pieplot <- pie + scale_fill_brewer(palette="Dark2") +  theme_void()

pieplot

ggsave("figures/pieplot.png")
```


<span style="text-decoration:underline">Summary</span>


<span style="text-decoration:underline">Future Directions</span>


